---
import Layout from "../layouts/Layout.astro";
---

<Layout title="createAdmin">
  <div class="main-container">
    <header>
      <h1>Create a Admin account</h1>
    </header>
    <div class="form-container">
      <form id="loginForm">
        <div class="input-container">
          <label for="email">Name</label>
          <input
            type="text"
            id="name_user"
            name="name_user"
            placeholder="Mike"
            required
          />
        </div>
        <div class="input-container">
          <label for="email">Lastname</label>
          <input
            type="text"
            id="lastname"
            name="lastname"
            placeholder="Johnson"
            required
          />
        </div>
        <div class="input-container">
          <label for="email">Username</label>
          <input
            type="text"
            id="username"
            name="username"
            placeholder="MJhonson"
            required
          />
        </div>
        <div class="input-container">
          <label for="email">Country</label>
          <input
            type="number"
            id="country"
            name="country"
            placeholder="Put a 1 for now"
            required
          />
        </div>
        <div class="input-container">
          <label for="email">Ocupation</label>
          <input
            type="text"
            id="ocupation"
            name="ocupation"
            placeholder="CEO"
            required
          />
        </div>
        <div class="input-container">
          <label for="email">Company</label>
          <input
            type="text"
            id="company"
            name="company"
            placeholder="Veritas"
            required
          />
        </div>
        <div class="input-container">
          <label for="email">Type of Journalist</label>
          <input
            type="text"
            id="type_of_journalist"
            name="type_of_journalist"
            placeholder="CEO"
            required
          />
        </div>
        <div class="input-container">
          <label for="email">identification</label>
          <input
            type="number"
            id="identification"
            name="identification"
            placeholder="Insert your identification"
            required
          />
        </div>
        <div class="input-container">
          <label for="email">Biography</label>
          <input
            type="text"
            id="biography"
            name="biography"
            placeholder="Describe your self"
            required
          />
        </div>
        <div class="input-container">
          <label for="email">Email:</label>
          <input
            type="text"
            id="email"
            name="email"
            placeholder="example@gmail.com"
            required
          />
        </div>
        <div class="input-container">
          <label for="password">Password:</label>
          <input
            type="password"
            id="password"
            name="password"
            placeholder="Pleace insert your password"
            required
          />
        </div>
        <button type="submit" onsubmit="handleLogin">Create Acount</button>
      </form>
    </div>
  </div>
</Layout>
<script>
  const form = document.getElementById("loginForm");
  const emailInput = document.getElementById("email") as HTMLInputElement;
  const passwordInput = document.getElementById("password") as HTMLInputElement;
  const name_userInput = document.getElementById(
    "name_user"
  ) as HTMLInputElement;
  const lastnameInput = document.getElementById("lastname") as HTMLInputElement;
  const usernameInput = document.getElementById("username") as HTMLInputElement;
  const countryInput = document.getElementById("country") as HTMLInputElement;
  const ocupationInput = document.getElementById(
    "ocupation"
  ) as HTMLInputElement;
  const companyInput = document.getElementById("company") as HTMLInputElement;
  const type_of_journalistInput = document.getElementById(
    "type_of_journalist"
  ) as HTMLInputElement;
  const identificationInput = document.getElementById(
    "identification"
  ) as HTMLInputElement;
  const biographyInput = document.getElementById(
    "biography"
  ) as HTMLInputElement;
  const formData = new FormData();
  console.log(formData, "llega la data?");

  form?.addEventListener("submit", async (event) => {
    event.preventDefault();
    console.log(`Email: ${emailInput.value} Password: ${passwordInput.value}`);

    const res = await fetch("http://localhost:1234/registerAdminUser", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        name_user: name_userInput.value,
        lastname: lastnameInput.value,
        username: usernameInput.value,
        email: emailInput.value,
        password: passwordInput.value,
        id_country: countryInput.value,
        ocupation: ocupationInput.value,
        company: companyInput.value,
        type_of_journalist: type_of_journalistInput.value,
        identification: identificationInput.value,
        biography: biographyInput.value,
      }),
    });
    const data = await res.json();
    console.log(`Response DATA: ${data}`);

    if (res.ok) {
      console.log('perfecto papa', data);
      window.location.href = '/';
    } else {
      console.error("Login failed:", data);
      alert("Login failed. Please check your credentials and try again.");
    }
  });
</script>
<style>
  h1,
  p {
    margin: 0;
    padding: 0;
  }
  h1 {
    font-size: 2rem;
  }
  p {
    font-size: 1rem;
    color: rgba(255, 255, 255, 0.8);
    font-weight: 300;
  }
  header {
    text-align: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 0.25rem;
  }
  .form-container {
    display: flex;
    justify-content: center;
    align-items: center;
  }
  #loginForm {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    max-width: 30rem;
    min-width: 15rem;
    background-color: #121212;
    padding: 2rem;
    border-radius: 8px;
    box-shadow:
      rgba(27, 33, 38, 0.48) 6px 2px 16px 0px,
      rgba(0, 0, 0, 0.8) -6px -2px 16px 0px;
  }
  .input-container {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  input {
    padding: 0.5rem;
    border-radius: 4px;
    border: none;
    background-color: #1e1e1e;
    color: white;
    font-size: 0.65rem;
  }
  label {
    font-size: 0.75rem;
  }
  button {
    cursor: pointer;
    font-weight: 800;
    padding-block: 0.5rem;
    margin-inline: 20%;
    border-radius: 25px;
    background-color: #ffc857;
    transition: background-color 0.3s ease;
    border: none;
    box-shadow: rgba(65, 45, 0, 0.09) 0px 3px 12px;
  }
  button:hover {
    background-color: #c58609;
  }
  .link {
    color: aliceblue;
    text-decoration: none;
    font-size: 12px;
    text-align: center;
  }
  .main-container {
    display: flex;
    gap: 20px;
    flex-direction: column;
  }
</style>
